<%= @post.title %>
<br>
<i>posted at: <%= @post.post_date %></i>
<br><br>
<%= @post.content %>
<br>
<%= link_to "Edit", edit_post_path(@post) %> |
<%= link_to(post_path(@post),
  data: {
    confirm: 'You sure?',
    method: 'delete'
  }
) do %>
  Delete
<% end %>
<%= form_tag(post_comments_path(@post), method: "post") do %>
  <%= hidden_field_tag :author_id, current_author.id %>
  <%= text_field_tag :content %>
  <%= submit_tag "Add a Comment" %>
<% end %>
<% @post.comments.each do |comment| %>
  <% if comment.parent == nil %>
    "<%= comment.content %>"<br>
    <i>posted at: <%= comment.created_at %></i><br>
    <i>Author:</i> <%= comment.author.name %><br>
    <%= link_to 'Reply', post_comment_path(@post, comment) %><br><br>
    <% comment.walk_tree do |comment, level| %>
    <% @margin = "margin-left:"+(level * 40).to_s+"px;" %>
    <div style=<%= @margin %>>
        "<%= comment.content %>"<br>
        <i>posted at: <%= comment.created_at %></i><br>
        <i>Author:</i> <%= comment.author.name %><br>
        <%= link_to 'Reply', post_comment_path(@post, comment) %><br><br>
    </div>
    <% end %>
  <% end %>
<% end %>
